<div class="container my-4 my-md-5">
  <!-- Exam Header -->
  <div class="card bg-light border-0 border-start border-primary border-4 rounded-3 mb-4 mb-md-5">
    <div class="card-body p-4">
      <h1 class="display-5 fw-bold mb-2">{{ exam?.examTitle || 'Examen' }}</h1>
      <h2 class="h4 text-muted mb-3">{{ exam?.subject }} - {{ exam?.section }}</h2>
      <p class="text-muted mb-3"><strong>Durée:</strong> {{ exam?.duration }} | <strong>Points:</strong> {{ exam?.maxPoints }} | <strong>Année:</strong> {{ exam?.sessionYear }}</p>
      <div class="bg-secondary bg-opacity-10 p-3 rounded-3 mt-3" *ngIf="exam?.instructions">
        <h3 class="h5 fw-semibold mb-2">Instructions</h3>
        <p class="mb-0">{{ exam?.instructions }}</p>
      </div>
    </div>
  </div>

  <!-- Questions -->
  <div *ngIf="exam?.questions">
    <div *ngFor="let question of exam?.questions" class="card border rounded-3 mb-3 mb-md-4">
      <div class="card-body p-4">
        <h3 class="h4 text-primary mb-3 pb-2 border-bottom">Question {{ question.number }} ({{ question.points }} points)</h3>
        <div class="mb-4 lh-lg" [innerHTML]="question.text | katex"></div>
        
        <div *ngFor="let subQuestion of question.subQuestions" class="bg-light p-3 rounded-3 mb-3">
          <h4 class="h5 fw-semibold mb-2">{{ subQuestion.label }}</h4>
          <div class="mb-3" [innerHTML]="subQuestion.text | katex"></div>
          
          <!-- Student Answer Area -->
          <div class="mb-3">
            <label class="form-label fw-semibold">Votre réponse:</label>
            <textarea class="form-control" placeholder="Tapez votre réponse ici..." rows="4"></textarea>
          </div>
          
          <!-- Hint (if available) -->
          <div class="alert alert-info mb-2" *ngIf="subQuestion.hint">
            <strong>Indice:</strong>
            <span [innerHTML]="subQuestion.hint | katex" class="d-inline"></span>
          </div>
          
          <!-- Answer (if available) -->
          <div class="alert alert-success mb-0" *ngIf="subQuestion.answer">
            <strong>Réponse:</strong>
            <span [innerHTML]="subQuestion.answer | katex" class="d-inline"></span>
            <div *ngIf="subQuestion.explanation" class="mt-2">
              <strong>Explication:</strong>
              <span [innerHTML]="subQuestion.explanation | katex" class="d-inline"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="card bg-light border-0 rounded-3 mt-4 mt-md-5">
    <div class="card-body text-center p-4">
      <div class="d-flex flex-column flex-sm-row gap-2 justify-content-center">
        <button class="btn btn-primary" (click)="saveAnswers()">Sauvegarder</button>
        <button class="btn btn-secondary" (click)="downloadExam()">Télécharger</button>
        <button class="btn btn-success" (click)="goBack()">Retour</button>
      </div>
    </div>
  </div>
</div>