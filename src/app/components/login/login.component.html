<app-navbar></app-navbar>

<div class="container-fluid auth-container edu-bg d-flex justify-content-center align-items-center mt-0">
  <div class="row w-100 gx-0">

    <!-- header panel -->
    <div class="col-12 col-md-6 auth-header p-4">
      <h2 class="auth-title">Bienvenu à la plateforme d'épreuves</h2>
      <p class="auth-subtitle">
        Inscrivez-vous pour accéder tous les outils disponible.
      </p>
    </div>

    <!-- form panel -->
    <div class="col-12 col-md-6 auth-box edu-shadow">
      <div class="auth-tabs">
        <div
          class="auth-tab"
          [class.active]="activeTab === 'login'"
          (click)="setActiveTab('login')">
          Login
        </div>
        <div
          class="auth-tab"
          [class.active]="activeTab === 'register'"
          (click)="setActiveTab('register')">
          Register
        </div>
      </div>

      <!-- login form -->
      @if (activeTab === 'login') {
      <form (ngSubmit)="login()" #loginForm="ngForm" class="edu-form">
        <div class="form-group">
          <label for="login-username" class="form-label">Username</label>
          <input 
            type="text" 
            id="login-username" 
            class="form-input"
            [(ngModel)]="credentials.username" 
            name="username" 
            required
            #usernameInput="ngModel"
            autocomplete="username">
          @if (usernameInput.invalid && usernameInput.touched) {
            <div class="validation-error">Username is required</div>
          }
        </div>

        <div class="form-group">
          <label for="login-password" class="form-label">Password</label>
          <input 
            type="password" 
            id="login-password" 
            class="form-input"
            [(ngModel)]="credentials.password" 
            name="password" 
            required
            minlength="6"
            #passwordInput="ngModel"
            autocomplete="current-password">
          @if (passwordInput.invalid && passwordInput.touched) {
            <div class="validation-error">
              Password must be at least 6 characters long
            </div>
          }
        </div>

        <button 
          type="submit" 
          class="submit-button edu-btn"
          [disabled]="loginForm.invalid || isSubmitting">
          {{ isSubmitting ? 'Logging in...' : 'Login' }}
        </button>

        @if (errorMessage) {
          <div class="error-message">{{ errorMessage }}</div>
        }

        @if (successMessage) {
          <div class="success-message">{{ successMessage }}</div>
        }
      </form>
    }

      <!-- register form -->
      @if (activeTab === 'register') {
      <form (ngSubmit)="register()" #registerForm="ngForm" class="edu-form">
        <div class="form-group">
          <label for="register-username" class="form-label">Username</label>
          <input 
            type="text" 
            id="register-username" 
            class="form-input"
            [(ngModel)]="user.username" 
            name="username" 
            required
            #regUsernameInput="ngModel"
            autocomplete="username">
          @if (regUsernameInput.invalid && regUsernameInput.touched) {
            <div class="validation-error">Nom utilisateur est Obligatoire</div>
          }
        </div>

        <div class="form-group">
          <label for="register-password" class="form-label">Password</label>
          <input 
            type="password" 
            id="register-password" 
            class="form-input"
            [(ngModel)]="user.password" 
            name="password" 
            required
            minlength="6"
            #regPasswordInput="ngModel"
            autocomplete="new-password">
          @if (regPasswordInput.invalid && regPasswordInput.touched) {
            <div class="validation-error">
              Mot de passe doit être au moins 6 caractères
            </div>
          }
        </div>

        <div class="form-group">
          <label for="register-firstname" class="form-label">Nom</label>
          <input 
            type="text" 
            id="register-firstname" 
            class="form-input"
            [(ngModel)]="user.first_name" 
            name="first_name"
            required
            #firstNameInput="ngModel">
          @if (firstNameInput.invalid && firstNameInput.touched) {
            <div class="validation-error">Nom et prénon sont Obligatoire</div>
          }
        </div>
        <div class="form-group">
          <label for="register-firstname" class="form-label">Votre prénon</label>
          <input 
            type="text" 
            id="register-ecole" 
            class="form-input"
            [(ngModel)]="user.last_name" 
            name="ecole"
            required
            #firstNameInput="ngModel">
          @if (firstNameInput.invalid && firstNameInput.touched) {
            <div class="validation-error">prénon</div>
          }
        </div>

        <button 
          type="submit" 
          class="submit-button edu-btn"
          [disabled]="registerForm.invalid || isSubmitting">
          {{ isSubmitting ? 'Creating account...' : 'Register' }}
        </button>

        @if (errorMessage) {
          <div class="error-message">{{ errorMessage }}</div>
        }

        @if (successMessage) {
          <div class="success-message">{{ successMessage }}</div>
        }
      </form>
    }
    </div>
  </div>
</div>

<app-footer></app-footer>
